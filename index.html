<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Merry Christmas My Queen</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --red-flat: #ff4d6d;
            --pink-bg: #ffafcc;
            --soft-pink: #ffc2d1;
            --white: #ffffff;
            --text-dark: #590d22;
        }

        body {
            margin: 0; padding: 0;
            background: linear-gradient(135deg, #ffc2d1 25%, #ffafcc 25%, #ffafcc 50%, #ffc2d1 50%, #ffc2d1 75%, #ffafcc 75%, #ffafcc 100%);
            background-size: 40px 40px;
            height: 100vh;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            touch-action: manipulation;
        }

        .handwriting { font-family: 'Dancing Script', cursive; }

        /* --- D·∫¢I ƒê√àN --- */
        .lights { position: fixed; top: 0; width: 100%; display: flex; justify-content: space-around; padding: 5px 0; z-index: 1500; }
        .light { width: 15px; height: 15px; border-radius: 50%; animation: blink 0.8s infinite alternate; }
        @keyframes blink { from { opacity: 0.3; transform: scale(0.8); } to { opacity: 1; transform: scale(1.1); box-shadow: 0 0 15px currentColor; } }

        /* --- LOADING --- */
        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffc2d1; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; transition: opacity 0.8s ease; }

        /* --- B·∫¢NG M·∫¨T KH·∫®U --- */
        #password-screen { display: none; text-align: center; z-index: 1000; background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 85%; max-width: 300px; }
        #password-input { padding: 12px; border-radius: 20px; border: 2px solid var(--red-flat); outline: none; text-align: center; font-family: 'Quicksand'; width: 90%; font-size: 16px; margin-bottom: 15px; box-sizing: border-box; }

        /* --- THI·ªÜP --- */
        .card-container { 
            display: none; opacity: 0; perspective: 1500px; 
            width: 90vw; max-width: 320px; height: 450px; 
            position: relative; z-index: 20; 
            transition: opacity 1s ease, transform 1s ease-in-out; 
        }
        .card-container.is-visible { display: block; opacity: 1; }
        
        /* Hi·ªáu ·ª©ng l·∫≠t tr√™n mobile: D·ªãch chuy·ªÉn √≠t h∆°n ƒë·ªÉ kh√¥ng tr√†n m√†n h√¨nh */
        .card-container.is-open { transform: translateX(25%); }

        .book { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: 1.2s cubic-bezier(0.645, 0.045, 0.355, 1); }
        .page { width: 100%; height: 100%; position: absolute; top: 0; left: 0; border-radius: 12px; transform-origin: left; transition: 1.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.1); overflow: hidden; }
        
        .cover-front { background: var(--red-flat); color: white; z-index: 10; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 20px; backface-visibility: hidden; border: 2px solid white; cursor: pointer; }
        
        .page-left { background: #fff9fa; z-index: 9; transform: rotateY(0deg); backface-visibility: visible; border: 1px solid #ffe5ec; }
        .page-left-content { 
            transform: rotateY(180deg); display: flex; flex-direction: column; 
            align-items: center; width: 100%; height: 100%; justify-content: center; padding: 10px; box-sizing: border-box;
        }

        .book.open .cover-front, .book.open .page-left { transform: rotateY(-180deg); }
        .page-right { background: white; z-index: 1; padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border: 1px solid #ffe5ec; }
        
        .ny-photo { width: 90%; height: 65%; object-fit: cover; border: 4px solid white; border-radius: 8px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }

        /* N√∫t b√≠ m·∫≠t */
        #secret-btn-wrapper { position: absolute; bottom: -60px; left: 50%; transform: translateX(-50%); z-index: 100; opacity: 0; display: none; transition: 1s ease; }
        #secret-btn-wrapper.slide-down { display: block; opacity: 1; bottom: 20px; }
        #secret-btn { padding: 10px 20px; background: white; color: var(--red-flat); border: 2px dashed var(--red-flat); border-radius: 30px; font-weight: 700; }

        /* Panel qu√† t·∫∑ng */
        #gift-panel { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8); width: 85%; max-width: 320px; background: white; border-radius: 20px; padding: 15px; box-shadow: 0 0 50px rgba(0,0,0,0.3); z-index: 3000; text-align: center; opacity: 0; transition: 0.5s ease; }
        #gift-panel.show { display: block; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        .secret-img { width: 100%; border-radius: 12px; max-height: 350px; object-fit: cover; margin-bottom: 10px; }

        /* V·∫≠t trang tr√≠ */
        .object { position: fixed; bottom: -10px; font-size: 80px; transition: 1s ease; opacity: 0; z-index: 5; }
        .show-objects #tree { left: 5%; opacity: 0.5; }
        .show-objects #gift-box { right: 5%; opacity: 0.5; }

        @media (min-width: 800px) {
            .card-container.is-open { transform: translateX(160px); }
            .object { font-size: 200px; }
        }
    </style>
</head>
<body>

    <audio id="bg-music" src="music.mp3" loop preload="auto"></audio>

    <div id="loading-screen">
        <div style="border:4px solid white; border-top:4px solid var(--red-flat); border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite;"></div>
        <h2 class="handwriting" style="color: var(--red-flat); margin-top: 15px;">ƒêang chu·∫©n b·ªã qu√†...</h2>
        <p id="timer" style="font-size: 24px; font-weight: bold; color: var(--text-dark);">5</p>
    </div>

    <div id="password-screen">
        <h2 class="handwriting" style="color: var(--red-flat); font-size: 1.8rem;">M·∫≠t kh·∫©u l√† g√¨ ·∫•y nh·ªâ:3</h2>
        <input type="text" id="password-input" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi...">
        <button class="capsule-2d" onclick="checkPassword()" style="padding: 10px 30px; font-size: 16px; background: var(--red-flat); color: white; border: none; border-radius: 20px;">X√°c nh·∫≠n</button>
        <p id="error-msg" style="color: red; font-size: 0.8rem; margin-top: 10px; display: none;">Sai r√≤i coi kƒ© xem c√≥ nh·∫ßm khem! ‚ù§Ô∏è</p>
    </div>

    <div class="lights" id="light-container"></div>

    <div id="start-btn-container" style="display: none; z-index: 1000;">
        <button class="capsule-2d" onclick="startExperience()" style="padding: 15px 30px; background: var(--red-flat); color: white; border: 2px solid white; border-radius: 50px; font-weight: bold; font-size: 1.2rem;">·∫§n v√¥ ƒë√¢y ƒëii ‚ù§Ô∏è</button>
    </div>

    <div class="card-container" id="cardContainer">
        <div class="book" id="book" onclick="openBook()">
            <div class="page page-right">
                <h2 class="handwriting" style="color: var(--red-flat); margin-bottom: 5px; font-size: 1.8rem;">Merry Christmas!</h2>
                <div style="font-size: 0.9rem; line-height: 1.4; color: var(--text-dark);">
                    <p>Ch√∫c bbi c·ªßa bin gi√°ng sinh vui v·∫ª nh√≥.</p>
                    <p>Bin hay b·ªã b√≠ t·ª´ l√©m n√™n l√†...</p>
                    <p>Bin ch√∫c ng·ªçc gi√°ng sinh vui v·∫ªe!</p>
                    <p>M·∫°nh kh·ªèe, ham ƒÉn ch√≥ng l·ªõn</p>
                    <p>V√† c√πng bin ƒëi qua nh√¨u m√πa gi√°ng sinh n·ªØa nh√°:3</p>
                </div>
                <p style="font-size: 1.2rem; margin: 5px 0;">üéÑ‚ú®üéÅ</p>
            </div>
            <div class="page page-left">
                <div class="page-left-content">
                    <img src="https://i.ibb.co/NgNW0Zs8/NgNW0Zs8.jpg" class="ny-photo">
                    <p class="handwriting" style="font-size: 1.1rem; color: var(--red-flat); margin-top: 8px;">‚ù§ ch√¢n dung g√°i ƒë·∫πp c·ªßa bin ‚ù§</p>
                </div>
            </div>
            <div class="page cover-front">
                <h1 class="handwriting" style="font-size: 1.8rem;">Ch√∫c bbi c·ªßa bin noel zui z·∫ª</h1>
                <span style="font-size: 2.5rem;">üëë</span>
                <p style="margin-top: 15px; font-size: 0.8rem; opacity: 0.8;">( Ch·∫°m ƒë·ªÉ m·ªü )</p>
            </div>
        </div>
        <div id="secret-btn-wrapper">
            <button id="secret-btn" onclick="showGift()">M·ªü qu√† b√≠ m·∫≠t ???</button>
        </div>
    </div>

    <div id="gift-panel">
        <h3 style="color: var(--red-flat); margin-top: 0;">Surprise! üéÅ</h3>
        <img src="https://i.ibb.co/8gZR2cSL/8gZR2cSL.jpg" class="secret-img">
        <p style="font-size: 0.8rem; color: var(--text-dark);">Qu√† bin t·∫∑ng ng·ªçc n√®eeee!</p>
        <button onclick="closeGift()" style="cursor:pointer; padding: 10px 25px; border:none; background:var(--red-flat); color:white; border-radius:10px; font-weight:700;">ƒê√≥ng</button>
    </div>

    <div id="tree" class="object">üéÑ</div>
    <div id="gift-box" class="object">üéÅ</div>

    <script>
        // C√°c h√†m x·ª≠ l√Ω gi·ªØ nguy√™n logic nh∆∞ng t·ªëi ∆∞u m∆∞·ª£t m√† h∆°n cho mobile
        window.onload = function() {
            let timeLeft = 5;
            const timerElement = document.getElementById('timer');
            const countdown = setInterval(() => {
                timeLeft--;
                if(timerElement) timerElement.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    const loader = document.getElementById('loading-screen');
                    loader.style.opacity = '0';
                    setTimeout(() => {
                        loader.style.display = 'none';
                        document.getElementById('password-screen').style.display = 'block';
                    }, 800);
                }
            }, 1000);

            const lContainer = document.getElementById('light-container');
            const pinkColors = ['#ff4d6d', '#ffafcc', '#ffc2d1', '#ffffff', '#fb6f92'];
            for(let i=0; i<12; i++) {
                const l = document.createElement('div');
                l.className = 'light';
                const color = pinkColors[i % pinkColors.length];
                l.style.backgroundColor = color;
                l.style.color = color;
                l.style.animationDelay = Math.random() * 2 + 's';
                lContainer.appendChild(l);
            }
        };

        function checkPassword() {
            const input = document.getElementById('password-input').value.trim().toLowerCase();
            const correctPass = "bin iu ng·ªçc nh·ªõt";
            if (input === correctPass) {
                document.getElementById('password-screen').style.display = 'none';
                const startBtn = document.getElementById('start-btn-container');
                startBtn.style.display = 'block';
            } else {
                const errorMsg = document.getElementById('error-msg');
                errorMsg.style.display = 'block';
                document.getElementById('password-input').style.borderColor = 'red';
            }
        }

        function startExperience() {
            const music = document.getElementById('bg-music');
            if(music) music.play().catch(() => console.log("C·∫ßn t∆∞∆°ng t√°c ƒë·ªÉ ph√°t nh·∫°c"));
            document.getElementById('start-btn-container').style.display = 'none';
            document.getElementById('cardContainer').classList.add('is-visible');
        }

        function openBook() {
            const book = document.getElementById('book');
            if(!book.classList.contains('open')) {
                book.classList.add('open');
                document.getElementById('cardContainer').classList.add('is-open');
                document.body.classList.add('show-objects');
                const secretWrapper = document.getElementById('secret-btn-wrapper');
                setTimeout(() => { 
                    secretWrapper.style.display = 'block';
                    setTimeout(() => { secretWrapper.classList.add('slide-down'); }, 50);
                }, 1200);
            }
        }

        function showGift() { 
            const panel = document.getElementById('gift-panel');
            panel.style.display = 'block';
            setTimeout(() => { panel.classList.add('show'); }, 10);
        }

        function closeGift() {
            const panel = document.getElementById('gift-panel');
            panel.classList.remove('show');
            setTimeout(() => { panel.style.display = 'none'; }, 500);
        }
    </script>
</body>
</html>
